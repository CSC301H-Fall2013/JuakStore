{% extends "base.html" %}
{% load i18n %}
{% load juakstore_extras %}


{% block title %}East Scarborough Storefront | Index{% endblock %}

{% block content %}

<script type="text/javascript" src="{{ STATIC_URL }}js/booking_add.js"></script>


<!-- 
<h1 class="headings_index">Bookings:</h1>
<div id="bookings_index">
{% if currentUser.is_staff %}

        <script type="text/javascript" src="{{ STATIC_URL }}js/booking_add.js"></script>

        <div id="bookings_index">
    <h1 class="headings_index">Make a Booking</h1>
        <form action={% url 'juakstore:bookingSubmit' %} method="post">{% csrf_token %}
            {{ form.as_p }}
            <input type="submit" value="Submit" />
        </form>
    </div>


        <h1 class="headings_index">Bookings:</h1>
        <div id="bookings_index">
        {% if all_bookings %}
                <ul>
                        {% for booking in all_bookings %}
                                <li><a href="{% url 'juakstore:bookingDetail' booking.id %}">{{ booking.name }}</a></li>
                        {% endfor %}
                </ul>
        {% else %}
                <p>No active bookings</p>
        {% endif %}
        </div>
        <form action="{%  url 'juakstore:bookingCreate' %}"><input type="submit" value="Add New" /></form>
        <h1 class="headings_index">Rooms:</h1>
        <div id="rooms_index">
        {% if all_rooms %}
                <ul>
                        {% for room in all_rooms %}
                                <li><a href="{% url 'juakstore:roomDetail' room.id %}">{{ room.name }}</a></li>
                        {% endfor %}
                </ul>
        {% else %}
                <p>No rooms!</p>
        {% endif %}
        </div>

        <!-- general user can't add a room
        <form action="{% url 'juakstore:roomCreate' %}"><input type="submit" value="Add Room" /></form>
        
{% else %}
        <h1 class="headings_index">My Bookings:</h1>
        <div id="bookings_index">
        {% if all_bookings %}
                <ul>
                        {% for booking in all_bookings %}
                                {% ifequal currentUser booking.booker %}
                                        <li><a href="{% url 'juakstore:bookingDetail' booking.id %}">{{ booking.name }}</a></li>
                                {% endifequal %}
                        {% endfor %}
                </ul>
        {% else %}
                <p>No active bookings</p>
        {% endif %}
        </div>
        <br>
        <br>
        <form action="{%  url 'juakstore:bookingCreate' %}"><input type="submit" value="Request New Booking" /></form> <br>
        <h1 class="headings_index">Rooms:</h1>
        <div id="rooms_index">
        {% if all_rooms %}
                <ul>
                        {% for room in all_rooms %}
                                <li><a href="{% url 'juakstore:roomDetail' room.id %}">{{ room.name }}</a></li>
                        {% endfor %}
                </ul>
        {% else %}
                <p>No rooms!</p>
        {% endif %}
        </div>


       
{% endif %}

</div>

-->

 <!-- general user can't add a room
        <form action="{% url 'juakstore:roomCreate' %}"><input type="submit" value="Add Room" /></form>
        -->

{% if not currentUser.is_staff %}
    <div id="bookings_index">
    <h1 class="headings_index">My Bookings:</h1>
    {% if all_bookings %}
	<ul>
	    {% for booking in all_bookings %}
		{% ifequal currentUser booking.booker %}
		    <li><a href="{% url 'juakstore:bookingDetail' booking.id %}">{{ booking.name }}</a></li>
		{% endifequal %}
	    {% endfor %}
	</ul>
    {% else %}
	<p>No active bookings</p>
    {% endif %}
    </div>
{% endif %}

<div class="clear"></div>

<div id="rooms_index">
<h1 class="headings_index">Rooms:</h1>
{% if all_rooms %}
    <ul>
        {% for room in all_rooms %}
            <li><a href="{% url 'juakstore:roomDetail' room.id %}">{{ room.name }}</a></li>
        {% endfor %}
    </ul>
{% else %}
    <p>No rooms!</p>
{% endif %}
</div>

<!-- general user can't add a room
<form action="{% url 'juakstore:roomCreate' %}"><input type="submit" value="Add Room" /></form>
-->



<div class="clear"></div>

<div id="blueprint">

    <h1 class="headings_index">Blue Print</h1>

    <p>Click on a room below to get information about that room</p>

    <dl class="image_map">
        <dd><a class="staffkitchen" title="" href=" {% url 'juakstore:roomDetail' 9 %}"></a></dd>
        <dd><a class="backspace" title="" href=" {% url 'juakstore:roomDetail' 6 %}"></a></dd>
        <dd><a class="office3" title="" href=" {% url 'juakstore:roomDetail' 12 %}"></a></dd>
        <dd><a class="office2" title="" href=" {% url 'juakstore:roomDetail' 11 %}"></a></dd>
        <dd><a class="office1" title="" href=" {% url 'juakstore:roomDetail' 10 %}"></a></dd>
        <dd><a class="meetingroom" title="" href=" {% url 'juakstore:roomDetail' 7 %}"></a></dd>
        <dd><a class="kitchen" title="" href=" {% url 'juakstore:roomDetail' 8 %}"></a></dd>
    </dl>

</div>
            



<div id="tribe-events-content-wrapper" class="tribe-clearfix">

<div id="tribe-events-content" class="tribe-events-month">

<div id="tabs">

    <div id="calendar">
    
        {% calendar all_bookings year month %}

        <div>
        <form action={% url 'juakstore:index' %} method="get">
        {% if month == 1 %}
            <input id="year" name="year" type="hidden" value={{ year|add:-1 }}>
            <input id="month" name="month" type="hidden" value="12">
{#        <a href="{% url 'juakstore:indexyymm' year|add:'-1' 12 %}">Prev</a>#}
        {% else %}
            <input id="year" name="year" type="hidden" value={{ year }}>
            <input id="month" name="month" type="hidden" value={{ month|add:'-1' }}>
{#        <a href="{% url 'juakstore:indexyymm' year month|add:'-1' %}">Prev</a>#}
        {% endif %}
            <input type="submit" value="Prev">
        </form>
        </div>

        <div>
        <form action={% url 'juakstore:index' %} method="get">
        {% if month == 12 %}
            <input id="year" name="year" type="hidden" value={{ year|add:1 }}>
            <input id="month" name="month" type="hidden" value="1">
        {% else %}
            <input id="year" name="year" type="hidden" value={{ year }}>
            <input id="month" name="month" type="hidden" value={{ month|add:'1' }}>
        {% endif %}
        <input type="submit" value="Next">
        </form>
        </div>
    </div>

    <div id="agenda" class="tribe-events-content tribe-events-month">
        {% agenda all_bookings year month day %}
    </div>

</div>

</div>

</div>




{% endblock %}
